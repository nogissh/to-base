version: '3'


services:

  back-app:
    container_name: mypage_back-app
    build: ./back-app
    working_dir: /home/docker/app
    command: > 
      /bin/bash -c "source ~/.bash_profile && \
                    python manage.py migrate && \
                    supervisord -n"
    expose:
      - 80
    environment:
      - VIRTUAL_HOST=api.toshikiohnogi.net
      - LETSENCRYPT_HOST=api.toshikiohnogi.net


networks:
  default:
    external:
      name: webproxy
